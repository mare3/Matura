WebService1.asmx.cs

using System; 
using System.Collections.Generic; 
using System.IO; 
using System.Web.Services; 
namespace A10{     <summary>    /// Summary description for WebService1    /// </summary>    [WebService(Namespace = "http://tempuri.org/")]    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]    [System.ComponentModel.ToolboxItem(false)]    // To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
    // [System.Web.Script.Services.ScriptService]    
public class WebService1 : System.Web.Services.WebService { 
       [WebMethod]       
 public double ProcitajKursNaDan(DateTime Datum, string valuta){  
          StreamReader f = new StreamReader(Server.MapPath("kurs.txt"));  
          double kurs = -1.0;            
while (!f.EndOfStream){            
    string linija = f.ReadLine();               
 string[] podaci = linija.Split('|');              
  if (podaci[0]== Datum.ToString()&&podaci[1]==valuta) { kurs = Convert.ToDouble(podaci[2]); }   
         }         
   f.Close();           
 return kurs;       
 }        
[WebMethod]   
    
 public bool UpisiKursNaDan(DateTime Datum,string valuta,double Kurs){         
   bool uspesno = false;       
     try {               
 string linija = Datum.ToString() + "|" + valuta + "|" + Kurs.ToString() +"\r\n";              
  File.AppendAllText(Server.MapPath("kurs.txt"),linija);            
    uspesno =true;   }          
  catch (Exception e) { }      
      return uspesno;        }   
     [WebMethod]        

public List<string> ProcitajSveValute(){           
 List<string> lista = new List<string>();            
string[] sveLinije = File.ReadAllLines(Server.MapPath("kurs.txt"));            
foreach (string linija in sveLinije) {                
string[] podaci = linija.Split('|');                
bool vecPostoji = false;                
foreach (string valuta in lista) {                    
if (valuta == podaci[1])
{vecPostoji = true;
} }                
if (!vecPostoji) lista.Add(podaci[1]);            
}            
return lista;       
}}}

Pregledkursa.aspx

 <title>Преглед курса</title>   
 <link href="stilovi.css" rel="stylesheet" /> 

azuriranjeKursneListe.aspx

<title>Ажурирање курсне листе</title>   
<link href="stilovi.css" rel="stylesheet" /> 

PregledKursa.aspx.cs

using System; 
namespace 
testA10{    
public partial class PregledKursa : System.Web.UI.Page{        
protected void Page_Load(object sender, EventArgs e){            
if (!IsPostBack){                
localhost.WebService1 ws1 = new localhost.WebService1();                
string[] lista = ws1.ProcitajSveValute();               
 DropDownListValute.DataSource = lista;                
DropDownListValute.DataBind();            
}}        

protected void Button1_Click(object sender, EventArgs e){            
localhost.WebService1 ws1 = new localhost.WebService1();           
 if (Calendar1.SelectedDate.ToString()== "01-Jan-01 00:00:00")
{                
lblKurs.Text = "Mорате селектовати датум!";}
else
{
double kurs = ws1.ProcitajKursNaDan(Calendar1.SelectedDate, DropDownListValute.SelectedValue);               
 if (kurs == -1) lblKurs.Text = "За тај датум и ту валуту нема података...";

                else lblKurs.Text = "Курс за " + DropDownListValute.SelectedValue + "=" + kurs.ToString() + "дин.";
    } 
   } 
  } 
 } 